<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="shared-styles.html">

<dom-module id="gnc-number-formatter">

	<template>
	    [[ formatted ]]
	</template>

	<script>
		class GncNumberFormatter extends Polymer.Element {
			static get is() {
				return 'gnc-number-formatter';
			}
			static get properties() {
				return {
					input: {
						type: Number,
						observer: '_formatNumber'
					},
					type: String,
					decimals: Number,
					formatted: String
				};
			}
			static get observers() {
				return [
					'_formatNumber(input, decimals)'
				];
			}
			static decimalAdjust(value, exp) {
				const type = 'round'; // ceil, floor
			    // If the exp is undefined or zero...
			    if (typeof exp === 'undefined' || +exp === 0) {
			      return Math[type](value);
			    }
			    value = +value;
			    exp = +exp;
			    // If the value is not a number or the exp is not an integer...
			    if (isNaN(value) || !(typeof exp === 'number' && exp % 1 === 0)) {
			      return NaN;
			    }
			    // Shift
			    value = value.toString().split('e');
			    value = Math[type](+(value[0] + 'e' + (value[1] ? (+value[1] - exp) : -exp)));
			    // Shift back
			    value = value.toString().split('e');
			    return +(value[0] + 'e' + (value[1] ? (+value[1] + exp) : exp));
			}
			_formatNumber(value, exp) {
				this.formatted = (this.type && this.type[0] === 'c' ?  '€ ' : '') +
					GncCurrencyFormatter.decimalAdjust(value, exp).toLocaleString('nl') +
					(this.type && this.type[0] === 'd' ?  'd' : '');
			}
		}

		window.customElements.define(GncNumberFormatter.is, GncNumberFormatter);
	</script>
</dom-module>
