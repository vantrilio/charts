<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="shared-styles.html">

<dom-module id="gnc-issue-detail">
	<template>
		<style include="iron-flex"></style>
	    <style include="shared-styles">
		    :host {
		        display: block;
		        padding: 0;
		    }
			.flex-horizontal {
	            @apply --layout-horizontal;
				border-bottom: 1px var(--app-hairline-color) solid;
				padding: 10px 0 10px 20px;
	        }
			.flex-vertical {
	            @apply --layout-vertical;
	        }
	        .flexchild {
	            @apply --layout-flex;
	        }
			.amount {
				font-size: calc(var(--app-font-size) * 1.6);
				font-weight: 700;
				margin-bottom: 6px;
			}
			.title {
				color: var(--app-primary-color);
				font-size: calc(var(--app-font-size) * 1.15);
				font-weight: 700;
				line-height: 1.6;
			}
			.sub-card {
				width: 140px;
				border-radius: 4px;
				background-color: var(--app-white-color);
				box-shadow: 0 0 12px rgba(80, 80, 80, .2);
				padding: 16px 4px;
				margin: 8px;
				text-align: center;
			}
			.sub-text {
				padding: 8px 20px;
			}
			.danger {
				color: var(--app-danger-color);
			}
			.warning {
				color: var(--app-warning-color);
			}
			.info {
				color: var(--app-primary-color);
			}
			.date {
				color: var(--app-muted-color);
			}
			.action-flex {
				border-left: 1px var(--app-hairline-color) solid;
			}
			.children {
				background-color: var(--app-palegrey-color);
				box-shadow: 0 0 12px rgba(80, 80, 80, .2);
			}
			.children .title {
				font-weight: normal;
			}
			.child-card {
				width: 80px;
				border: 1px var(--app-hairline-color) solid;
				border-radius: 4px;
				background-color: var(--app-white-color);
				padding: 12px 4px;
				margin: 8px;
				text-align: center;
			}
			paper-icon-button {
				color: var(--app-primary-color);
			}
	    </style>

		<div class="flex-horizontal">
			<div class="flex-vertical sub-card">
				<div class$="amount [[ issue.level ]]">[[ issue.amount ]]</div>
				<div>[[ issue.amountSubText ]]</div>
			</div>
			<div class="flex-vertical flexchild sub-text">
				<div class="date">[[ issue.date ]]</div>
				<div class="title">[[ issue.title ]]</div>
				<div>[[ issue.description ]]</div>
			</div>
			<div class="flex-vertical action-flex">
				<paper-icon-button icon="gnc-icons:arrow-down" on-click="_toggleChildren"></paper-icon-button>
			</div>
		</div>
		<template is="dom-if" if="[[ showChildren ]]">
			<div class="children">
				<template is="dom-repeat" items="[[ issue.relatedIssues ]]">
					<div class="flex-horizontal">
						<div class="flex-vertical child-card">
							<div class$="amount [[ item.level ]]">[[ item.amount ]]</div>
							<div>[[ item.amountSubText ]]</div>
						</div>
						<div class="flex-vertical flexchild sub-text">
							<div class="date">[[ item.date ]]</div>
							<div class="title">[[ item.title ]]</div>
							<div>[[ item.description ]]</div>
						</div>
						<div class="flex-vertical action-button">
							<paper-icon-button icon="gnc-icons:arrow-down" on-click="_toggleDetails"></paper-icon-button>
						</div>
					</div>
				</template>
			</div>
		</template>
	</template>

	<script>
		class GncIssueDetail extends Polymer.Element {
			static get is() {
				return 'gnc-issue-detail';
			}
			static get properties() {
				return {
					issue: Object,
					showChildren: Boolean
				}
			}
			_toggleChildren() {
				this.showChildren = !this.showChildren;
			}
			_toggleDetails(ev) {
				console.log(ev);
			}
		}

		window.customElements.define(GncIssueDetail.is, GncIssueDetail);
	</script>
</dom-module>
